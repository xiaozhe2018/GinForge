# CRUD ä»£ç ç”Ÿæˆå™¨ä»‹ç»

## ğŸ¯ ä»€ä¹ˆæ˜¯ä»£ç ç”Ÿæˆå™¨ï¼Ÿ

**GinForge CRUD ä»£ç ç”Ÿæˆå™¨**æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è„šæ‰‹æ¶å·¥å…·ï¼Œå¯ä»¥æ ¹æ®æ•°æ®åº“è¡¨ç»“æ„è‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„ CRUD ä»£ç ï¼ŒåŒ…æ‹¬åç«¯å’Œå‰ç«¯çš„å…¨éƒ¨ä»£ç ã€‚

### æ ¸å¿ƒåŠŸèƒ½

âœ… **è‡ªåŠ¨ç”Ÿæˆåç«¯ä»£ç **
- Modelï¼ˆæ•°æ®æ¨¡å‹ + è¯·æ±‚/å“åº”ç»“æ„ï¼‰
- Repositoryï¼ˆCRUD + åˆ†é¡µ + æœç´¢ + æ’åºï¼‰
- Serviceï¼ˆä¸šåŠ¡é€»è¾‘ + éªŒè¯ï¼‰
- Handlerï¼ˆHTTP å¤„ç† + Swagger æ³¨é‡Šï¼‰

âœ… **è‡ªåŠ¨ç”Ÿæˆå‰ç«¯ä»£ç **
- TypeScript API æ¥å£å®šä¹‰
- Vue 3 åˆ—è¡¨é¡µé¢ï¼ˆå¸¦æœç´¢ã€åˆ†é¡µã€æ’åºï¼‰
- Vue 3 è¡¨å•é¡µé¢ï¼ˆå¸¦æ•°æ®éªŒè¯ï¼‰

âœ… **æ™ºèƒ½ç‰¹æ€§**
- å­—æ®µç±»å‹è‡ªåŠ¨æ˜ å°„ï¼ˆMySQL â†’ Go â†’ TypeScriptï¼‰
- è¡¨å•ç±»å‹æ™ºèƒ½è¯†åˆ«ï¼ˆinput/textarea/select/switch/dateï¼‰
- éªŒè¯è§„åˆ™è‡ªåŠ¨ç”Ÿæˆï¼ˆrequired/email/min/maxï¼‰
- è½¯åˆ é™¤æ”¯æŒï¼ˆè‡ªåŠ¨è¯†åˆ« deleted_atï¼‰
- æ—¶é—´æˆ³æ”¯æŒï¼ˆè‡ªåŠ¨è¯†åˆ« created_at/updated_atï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¼–è¯‘ç”Ÿæˆå™¨

```bash
cd /Users/chaojidoudou/project/go/GinForge
go build -o bin/generator ./cmd/generator
```

### 2. æŸ¥çœ‹å¸®åŠ©

```bash
./bin/generator --help
```

è¾“å‡ºï¼š
```
GinForge è„šæ‰‹æ¶å·¥å…· - å¿«é€Ÿç”Ÿæˆ CRUD ä»£ç 

è¿™ä¸ªå·¥å…·å¯ä»¥å¸®åŠ©æ‚¨ï¼š
  â€¢ ä»æ•°æ®åº“è¡¨è‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„ CRUD ä»£ç 
  â€¢ ç”Ÿæˆåç«¯ä»£ç ï¼šModelã€Repositoryã€Serviceã€Handler
  â€¢ ç”Ÿæˆå‰ç«¯ä»£ç ï¼šAPIã€Vue åˆ—è¡¨é¡µã€è¡¨å•é¡µ
  â€¢ æ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿å’Œé…ç½®æ–‡ä»¶
  â€¢ å¤§å¹…æå‡å¼€å‘æ•ˆç‡
```

### 3. åˆ—å‡ºæ•°æ®åº“è¡¨

```bash
./bin/generator list:tables
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
æ‰¾åˆ° 12 ä¸ªè¡¨:
  1. admin_users
  2. admin_roles
  3. admin_menus
  ...
```

### 4. ç”Ÿæˆ CRUD ä»£ç 

#### æ–¹å¼ 1ï¼šä¸€é”®ç”Ÿæˆï¼ˆæ¨èï¼‰â­

```bash
# ç”Ÿæˆä»£ç å¹¶è‡ªåŠ¨æ³¨å†Œè·¯ç”±å’Œèœå•
./bin/generator gen:crud --table=articles --module=admin --auto-register

# æˆ–ä½¿ç”¨ç®€å†™
./bin/generator gen:crud --table=articles --module=admin -a
```

**è¿™æ˜¯æœ€å¿«çš„æ–¹å¼ï¼** ç”Ÿæˆå™¨ä¼šè‡ªåŠ¨å®Œæˆï¼š
- âœ… ç”Ÿæˆæ‰€æœ‰ä»£ç 
- âœ… æ³¨å†Œåç«¯è·¯ç”±
- âœ… æ³¨å†Œå‰ç«¯è·¯ç”±
- âœ… æ³¨å†Œèœå•
- âœ… å¯¼å…¥å›¾æ ‡

**åªéœ€é‡å¯æœåŠ¡å³å¯ä½¿ç”¨ï¼**

#### æ–¹å¼ 2ï¼šé¢„è§ˆæ¨¡å¼

```bash
./bin/generator gen:crud --table=articles --module=admin -a --dry-run
```

å…ˆé¢„è§ˆä¼šç”Ÿæˆå“ªäº›æ–‡ä»¶å’Œæ³¨å†Œå“ªäº›è·¯ç”±ï¼Œç¡®è®¤æ— è¯¯åå†æ­£å¼ç”Ÿæˆã€‚

#### æ–¹å¼ 3ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶

```bash
# 1. ç”Ÿæˆé…ç½®æ–‡ä»¶
./bin/generator init:config --table=articles

# 2. ç¼–è¾‘é…ç½®æ–‡ä»¶ generator/articles.yaml

# 3. ä»é…ç½®æ–‡ä»¶ç”Ÿæˆå¹¶è‡ªåŠ¨æ³¨å†Œ
./bin/generator gen:crud --config=generator/articles.yaml -a
```

---

## ğŸ“Š ç”Ÿæˆç»“æœ

### ä½¿ç”¨è‡ªåŠ¨æ³¨å†Œï¼ˆ-aï¼‰

ç”Ÿæˆå®Œæˆåï¼Œæ‚¨ä¼šçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š

```
âœ… ä»£ç ç”Ÿæˆå®Œæˆï¼

ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶:
  âœ… services/admin-api/internal/model/article.go
  âœ… services/admin-api/internal/repository/article_repository.go
  âœ… services/admin-api/internal/service/article_service.go
  âœ… services/admin-api/internal/handler/article_handler.go
  âœ… web/admin/src/api/article.ts
  âœ… web/admin/src/views/Article/index.vue
  âœ… web/admin/src/views/Article/Form.vue

ğŸ”§ è‡ªåŠ¨æ³¨å†Œè·¯ç”±å’Œèœå•...
âœ… åç«¯è·¯ç”±æ³¨å†ŒæˆåŠŸ
âœ… å‰ç«¯è·¯ç”±æ³¨å†ŒæˆåŠŸ
âœ… èœå•æ³¨å†ŒæˆåŠŸ
âœ… è·¯ç”±å’Œèœå•æ³¨å†Œå®Œæˆï¼

ğŸ“Œ åç»­æ­¥éª¤:
  âœ… åç«¯è·¯ç”±å·²è‡ªåŠ¨æ³¨å†Œ
  âœ… å‰ç«¯è·¯ç”±å·²è‡ªåŠ¨æ³¨å†Œ
  âœ… èœå•å·²è‡ªåŠ¨æ³¨å†Œ

  ğŸš€ ç°åœ¨åªéœ€é‡å¯æœåŠ¡å³å¯ä½¿ç”¨ï¼
     åç«¯: cd services/admin-api && go run cmd/server/main.go
     å‰ç«¯: åˆ·æ–°æµè§ˆå™¨
```

### ä¸ä½¿ç”¨è‡ªåŠ¨æ³¨å†Œ

å¦‚æœä¸ä½¿ç”¨ `-a` é€‰é¡¹ï¼Œéœ€è¦æ‰‹åŠ¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

```
ğŸ“Œ åç»­æ­¥éª¤:
  1. åœ¨è·¯ç”±æ–‡ä»¶ä¸­æ³¨å†Œæ–°çš„ Handler
  2. åœ¨å‰ç«¯è·¯ç”±ä¸­æ·»åŠ æ–°é¡µé¢
  3. åœ¨èœå•ä¸­æ·»åŠ å…¥å£
  4. é‡å¯æœåŠ¡å¹¶æµ‹è¯•åŠŸèƒ½

ğŸ’¡ æç¤º: ä½¿ç”¨ --auto-register æˆ– -a é€‰é¡¹å¯ä»¥è‡ªåŠ¨å®Œæˆä¸Šè¿°æ­¥éª¤
```

---

## ğŸ’¡ æ ¸å¿ƒä¼˜åŠ¿

### âš¡ æ•ˆç‡æå‡ 12-14 å€

ä¼ ç»Ÿæ‰‹å†™ä¸€ä¸ª CRUD æ¨¡å—ï¼ˆåŒ…å«å‰åç«¯ï¼‰éœ€è¦ **6-7 å°æ—¶**ï¼Œä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ï¼ˆè‡ªåŠ¨æ³¨å†Œï¼‰åªéœ€ **30 åˆ†é’Ÿ**ï¼

| ä»»åŠ¡ | ä¼ ç»Ÿæ‰‹å†™ | æ‰‹åŠ¨æ³¨å†Œ | è‡ªåŠ¨æ³¨å†Œ â­ |
|------|---------|---------|------------|
| Model | 30 åˆ†é’Ÿ | 10 ç§’ | 10 ç§’ |
| Repository | 45 åˆ†é’Ÿ | 10 ç§’ | 10 ç§’ |
| Service | 60 åˆ†é’Ÿ | 10 ç§’ | 10 ç§’ |
| Handler | 45 åˆ†é’Ÿ | 10 ç§’ | 10 ç§’ |
| å‰ç«¯ API | 20 åˆ†é’Ÿ | 10 ç§’ | 10 ç§’ |
| å‰ç«¯åˆ—è¡¨ | 90 åˆ†é’Ÿ | 10 ç§’ | 10 ç§’ |
| å‰ç«¯è¡¨å• | 60 åˆ†é’Ÿ | 10 ç§’ | 10 ç§’ |
| æ³¨å†Œè·¯ç”±å’Œèœå• | 30 åˆ†é’Ÿ | 10 åˆ†é’Ÿ | **è‡ªåŠ¨** |
| æµ‹è¯•è°ƒè¯• | 30 åˆ†é’Ÿ | 30 åˆ†é’Ÿ | 30 åˆ†é’Ÿ |
| **æ€»è®¡** | **6-7 å°æ—¶** | **45 åˆ†é’Ÿ** | **30 åˆ†é’Ÿ** |
| **æ•ˆç‡æå‡** | **åŸºå‡†** | **8-9x** | **12-14x** |

### ğŸ¯ ä»£ç è´¨é‡

- âœ… ç»Ÿä¸€çš„ä»£ç é£æ ¼
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- âœ… è§„èŒƒçš„ API è®¾è®¡
- âœ… ç¬¦åˆæœ€ä½³å®è·µ
- âœ… åŒ…å« Swagger æ³¨é‡Š

### ğŸ”§ é«˜åº¦å¯å®šåˆ¶

- âœ… æ”¯æŒè‡ªå®šä¹‰é…ç½®æ–‡ä»¶
- âœ… æ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿
- âœ… çµæ´»çš„å­—æ®µé…ç½®
- âœ… ä¸°å¯Œçš„éªŒè¯è§„åˆ™

---

## ğŸ“– å¯ç”¨å‘½ä»¤

### gen:crud

ç”Ÿæˆå®Œæ•´çš„ CRUD ä»£ç ï¼ˆåç«¯ + å‰ç«¯ï¼‰

```bash
./bin/generator gen:crud --table=<è¡¨å> --module=<æ¨¡å—>
```

**é€‰é¡¹**ï¼š
- `--table, -t` - æ•°æ®åº“è¡¨åï¼ˆå¿…å¡«ï¼‰
- `--module, -m` - æ¨¡å—åç§°ï¼ˆé»˜è®¤ï¼šadminï¼‰
- `--config, -c` - é…ç½®æ–‡ä»¶è·¯å¾„
- `--frontend` - æ˜¯å¦ç”Ÿæˆå‰ç«¯ä»£ç ï¼ˆé»˜è®¤ï¼štrueï¼‰
- `--force, -f` - å¼ºåˆ¶è¦†ç›–å·²å­˜åœ¨çš„æ–‡ä»¶
- `--dry-run` - é¢„è§ˆæ¨¡å¼ï¼Œä¸å®é™…åˆ›å»ºæ–‡ä»¶
- `--verbose, -v` - æ˜¾ç¤ºè¯¦ç»†è¾“å‡º

### gen:model

åªç”Ÿæˆ Model æ•°æ®æ¨¡å‹

```bash
./bin/generator gen:model --table=<è¡¨å> --module=<æ¨¡å—>
```

### init:config

ç”Ÿæˆé…ç½®æ–‡ä»¶æ¨¡æ¿

```bash
./bin/generator init:config --table=<è¡¨å>
```

### list:tables

åˆ—å‡ºæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨

```bash
./bin/generator list:tables
```

---

## ğŸ¨ æ™ºèƒ½ç‰¹æ€§è¯¦è§£

### 1. å­—æ®µç±»å‹è‡ªåŠ¨æ˜ å°„

ç”Ÿæˆå™¨ä¼šè‡ªåŠ¨å°† MySQL ç±»å‹æ˜ å°„åˆ° Go å’Œ TypeScript ç±»å‹ï¼š

| MySQL ç±»å‹ | Go ç±»å‹ | TypeScript ç±»å‹ | è¡¨å•ç±»å‹ |
|-----------|---------|-----------------|---------|
| int | int | number | input |
| bigint | int64 | number | input |
| varchar | string | string | input |
| text | string | string | textarea |
| datetime | time.Time | string | datetime |
| tinyint(1) | bool | boolean | switch |

### 2. è¡¨å•ç±»å‹æ™ºèƒ½è¯†åˆ«

æ ¹æ®å­—æ®µåè‡ªåŠ¨è¯†åˆ«æœ€åˆé€‚çš„è¡¨å•ç±»å‹ï¼š

- `password` â†’ å¯†ç è¾“å…¥æ¡†
- `email` â†’ é‚®ç®±è¾“å…¥æ¡†
- `content`, `description` â†’ å¤šè¡Œæ–‡æœ¬æ¡†
- `is_*` â†’ å¼€å…³ï¼ˆswitchï¼‰
- `status`, `type`, `category` â†’ ä¸‹æ‹‰é€‰æ‹©
- `*_at` â†’ æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨

### 3. éªŒè¯è§„åˆ™è‡ªåŠ¨ç”Ÿæˆ

æ ¹æ®å­—æ®µå±æ€§è‡ªåŠ¨ç”ŸæˆéªŒè¯è§„åˆ™ï¼š

- éç©ºå­—æ®µ â†’ `required`
- email å­—æ®µ â†’ `required, email`
- phone å­—æ®µ â†’ `required, len:11`
- password å­—æ®µ â†’ `required, min:6`
- varchar(255) â†’ `required, max:255`

### 4. è½¯åˆ é™¤æ”¯æŒ

å¦‚æœè¡¨æœ‰ `deleted_at` å­—æ®µï¼Œè‡ªåŠ¨å¯ç”¨è½¯åˆ é™¤åŠŸèƒ½ï¼š

```go
// è‡ªåŠ¨ç”Ÿæˆè½¯åˆ é™¤æ–¹æ³•
func (r *Repository) Delete(id uint64) error {
    return r.db.Delete(&Model{}, id).Error
}

func (r *Repository) ForceDelete(id uint64) error {
    return r.db.Unscoped().Delete(&Model{}, id).Error
}

func (r *Repository) Restore(id uint64) error {
    return r.db.Model(&Model{}).Unscoped().
        Where("id = ?", id).
        Update("deleted_at", nil).Error
}
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

- ğŸ“– [è¯¦ç»†ä½¿ç”¨æŒ‡å—](./usage) - äº†è§£æ‰€æœ‰å‘½ä»¤å’Œé€‰é¡¹
- âš™ï¸ [é…ç½®æ–‡ä»¶è¯¦è§£](./configuration) - è‡ªå®šä¹‰ç”Ÿæˆè§„åˆ™
- ğŸ’¼ [å®æˆ˜ç¤ºä¾‹](./examples) - å®Œæ•´çš„ä¸šåŠ¡æ¨¡å—å¼€å‘

**å¼€å§‹ä½¿ç”¨ä»£ç ç”Ÿæˆå™¨ï¼Œè®©å¼€å‘æ•ˆç‡æå‡ 10 å€ï¼** ğŸš€

